<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Title}} - Nexus</title>
    <link rel="stylesheet" href="/ui/static/css/style.css">
    <script src="/ui/static/js/htmx.min.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="navbar-brand">
            <a href="/ui/">
                <span class="logo">N</span>
                <span class="brand-name">Nexus</span>
            </a>
        </div>
        <ul class="navbar-nav">
            <li class="nav-item{{if eq .CurrentPath "/sessions"}} active{{end}}">
                <a href="/ui/sessions">Sessions</a>
            </li>
            <li class="nav-item{{if eq .CurrentPath "/analytics"}} active{{end}}">
                <a href="/ui/analytics">Analytics</a>
            </li>
            <li class="nav-item{{if eq .CurrentPath "/providers"}} active{{end}}">
                <a href="/ui/providers">Providers</a>
            </li>
            <li class="nav-item{{if eq .CurrentPath "/cron"}} active{{end}}">
                <a href="/ui/cron">Cron</a>
            </li>
            <li class="nav-item{{if eq .CurrentPath "/skills"}} active{{end}}">
                <a href="/ui/skills">Skills</a>
            </li>
            <li class="nav-item{{if eq .CurrentPath "/tools"}} active{{end}}">
                <a href="/ui/tools">Tools</a>
            </li>
            <li class="nav-item{{if eq .CurrentPath "/nodes"}} active{{end}}">
                <a href="/ui/nodes">Nodes</a>
            </li>
            <li class="nav-item{{if eq .CurrentPath "/config"}} active{{end}}">
                <a href="/ui/config">Config</a>
            </li>
            <li class="nav-item{{if eq .CurrentPath "/webchat"}} active{{end}}">
                <a href="/ui/webchat">WebChat</a>
            </li>
            <li class="nav-item{{if eq .CurrentPath "/status"}} active{{end}}">
                <a href="/ui/status">Status</a>
            </li>
        </ul>
        {{if .User}}
        <div class="navbar-user">
            <span class="user-name">{{.User.Name}}</span>
        </div>
        {{end}}
    </nav>

    <main class="container">
        {{if .Error}}
        <div class="alert alert-error">
            {{.Error}}
        </div>
        {{end}}

        {{if .Flash}}
        <div class="alert alert-success">
            {{.Flash}}
        </div>
        {{end}}

        {{/* Render the appropriate content based on the page */}}
        {{if eq .CurrentPath "/sessions"}}
            {{template "sessions/list.html" .}}
        {{else if eq .CurrentPath "/analytics"}}
            {{template "analytics/page.html" .}}
        {{else if eq .CurrentPath "/providers"}}
            {{template "providers/page.html" .}}
        {{else if eq .CurrentPath "/cron"}}
            {{template "cron/page.html" .}}
        {{else if eq .CurrentPath "/skills"}}
            {{template "skills/page.html" .}}
        {{else if eq .CurrentPath "/tools"}}
            {{template "tools/page.html" .}}
        {{else if eq .CurrentPath "/nodes"}}
            {{template "nodes/page.html" .}}
        {{else if eq .CurrentPath "/config"}}
            {{template "config/page.html" .}}
        {{else if eq .CurrentPath "/webchat"}}
            {{template "webchat/page.html" .}}
        {{else if hasPrefix .CurrentPath "/sessions/"}}
            {{template "sessions/detail.html" .}}
        {{else if eq .CurrentPath "/status"}}
            {{template "status/dashboard.html" .}}
        {{else}}
            <div class="content">
                <h1>{{.Title}}</h1>
                {{if .Error}}
                <p>{{.Error}}</p>
                {{end}}
            </div>
        {{end}}
    </main>

    <footer class="footer">
        <div class="container">
            <p>Nexus Gateway Dashboard</p>
        </div>
    </footer>
</body>
</html>
